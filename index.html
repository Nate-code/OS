<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="">
    <title>OS</title>
    <style>
        #os {
            height: 100%;
            width: 100%;
            display: none;
        }
        #browserapp {
            position: absolute;
            height: 50%;
            width: 50%;
            background-color: black;
        }
        #appbar {
            background-color: white;
        }
        #appbarstuff {
            float: right;
        }
        #loginpage {
            height: 100%;
            width: 100%;
            margin: 0;
            padding: 0;
            background-color: black;
        }
        #logindiv {
            background-color: mediumspringgreen;
            height: 50%;
            width: 400px;
            margin: auto;
        }
        #showpasswordwrong {
            color: red;
        }
        #screensaver {
            position: absolute;
            left: 0;
            top: 0;
            display: none;
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
        }
        #screensaverimage {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
        }
    </style>
</head>
<body>
    <div id="loginpage">
        <img id="screensaverimage" src="https://www.w3schools.com/w3css/img_lights.jpg">
        <div id="screensaver">
            <div id="logindiv">
                <h2 id="loginpagewelcome"></h2>
                <input id="logintext" type="password">
                <nav>
                    <button id="loginbutton">Login</button>
                    <button id="addaccountbutton">Modify Account</button>
                    <button id="showpassword">Show Password</button>
                    <button id="cancellogin">Cancel</button>
                </nav>
                <p id="showpasswordwrong"></p>
            </div>
        </div>
    </div>
    <div id="os">
        <div id="apppanel"></div>
        <div id="osbody">
            <div class="app "id="browserapp" draggable="true">
                <div id="appbar">
                    <button class="appbarstuff" id="exitwindow">X</<button>
                    <button class="appbarstuff" id="expandwindow">O</<button>
                </div>
                <div></div>
                <div id="appcontent"></div>
            </div>
        </div>
        <div id="mainpanel">
            <div id="clock">
                <p id="clockinput"></p>
            </div>
        </div>
    </div>
    <script>

        var loginpage = document.getElementById("loginpage");
        var os = document.getElementById("os");

        localStorage.username;
        localStorage.password;

        var logintext = document.getElementById("logintext");
        var loginbutton = document.getElementById("loginbutton");

        var showpassword = document.getElementById("showpassword");
        var cancellogin = document.getElementById("cancellogin");

        var loginvalue;
        var encryptionvalue;

        var modaccountbutton = document.getElementById("addaccountbutton");

        var loginpagewelcome = document.getElementById("loginpagewelcome");
        var showpasswordwrong = document.getElementById("showpasswordwrong");

        var screensaver = document.getElementById("screensaver");
        var screensaverimage = document.getElementById("screensaverimage");

        if (localStorage.username === undefined) {
            localStorage.username = "New User";
        }

        if (localStorage.password === undefined) {
            localStorage.password = "Password";
        }

        loginpagewelcome.innerHTML = "Welcome" + " " + localStorage.username;

        loginpage.addEventListener("mousedown", function() {
            screensaver.style.display = "block";
        });

        loginbutton.addEventListener("click", function() {
            loginvalue = logintext.value;
            if (loginvalue == localStorage.password) {
                login();
            } else {
                loginincorrect();
            }
        });

        logintext.addEventListener("keydown", function(event) {
            var logintextkey = event.keyCode;

            if (logintextkey == 13 && logintext.value == localStorage.password) {
                login();
            } else if (logintextkey == 13 && logintext.value != localStorage.password) {
                loginincorrect();
            }
        });

        function login() {
            loginpage.style.display = "none";
            os.style.display = "block";
        }

        function loginincorrect() {
            logintext.value = "";

            showpasswordwrong.innerText = "*Password Incorrect";
        }

        showpassword.addEventListener("click", function() {
            logintext.type = "text";

            setTimeout(() => {
                logintext.type = "password";
            }, 1000);
        });

        cancellogin.addEventListener("click", function() {
            screensaver.style.display = "none";
        });

        var currentpassword = localStorage.password;
        var newusername;
        var newpassword;

        modaccountbutton.addEventListener("click", function() {
            modaccount()
        });

        function modaccount () {
            if (localStorage.password === undefined) {
            } else {
                varifyuser()
            }
        }

        var varifyuserwrong;

        function varifyuser() {
            var userpassword = window.prompt("Enter Current Password");

            if (userpassword == localStorage.password) {
                modifyaccount();
            } else {
                alert("Password Incorect");

                location.reload();
            }
        }

        function lockscreen () {
            loginpage.style.display = "block";
            os.style.display = "none";
        }

        function modifyaccount() {
            var newusername = window.prompt("Enter New Username")
            var newpassword = window.prompt("Enter New Password");
            localStorage.username = newusername;
            localStorage.password = newpassword;

            localStorage.hasusername = true;
            localStorage.haspassword = true;

            loginpagewelcome.innerText = "Welcome" + " " + localStorage.username;
        }

        var clockinput = document.getElementById("clockinput");

        var clockhvalue = new Date().getHours();
        var clockmvalue = new Date().getMinutes();

        loginpagewelcome.innerHTML = "Welcome" + " " + localStorage.username;

        function liveclock () {
            clockinput.innerText = clockhvalue + ":" + clockmvalue;
        }

        var clock = setInterval(liveclock, 1);

        var appwindowdisplay;
        var appwindowmax;

        appwindowdisplay = true;
        appwindowmax = false;

        var app = document.getElementsByClassName("app");

        var browserapp = document.getElementById("browserapp");

        var exitwindow = document.getElementById("exitwindow");
        var expandwindow = document.getElementById("expandwindow");

        exitwindow.addEventListener("click", function () {
            app.style.display = "none";
        });

        function windowsizemax() {
            app.style.width = "100%";
            rapp.style.height = "100%";

            appwindowmax = true;
        }

        function windowsizemin() {
            app.style.width = "50%";
            app.style.height = "50%";

            appwindowmax = false;
        }

        expandwindow.addEventListener("click", function() {
            if (appwindowmax) {
                windowsizemin();
            } else if (!appwindowmax) {
                windowsizemax();
            }
        });

        function browser() {
            dragElement(document.getElementById("browserapp"));

            function dragElement(elmnt) {
                var pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
                if (document.getElementById(elmnt.id + "header")) {
                    document.getElementById(elmnt.id + "header").onmousedown = dragMouseDown;
                } else {
                    elmnt.onmousedown = dragMouseDown;
                }

                function dragMouseDown(e) {
                    e = e || window.event;
                    e.preventDefault();
                    pos3 = e.clientX;
                    pos4 = e.clientY;
                    document.onmouseup = closeDragElement;
                    document.onmousemove = elementDrag;
                }

                function elementDrag(e) {
                    e = e || window.event;
                    e.preventDefault();
                    pos1 = pos3 - e.clientX;
                    pos2 = pos4 - e.clientY;
                    pos3 = e.clientX;
                    pos4 = e.clientY;
                    elmnt.style.top = (elmnt.offsetTop - pos2) + "px";
                    elmnt.style.left = (elmnt.offsetLeft - pos1) + "px";
                }

                function closeDragElement() {
                    document.onmouseup = null;
                    document.onmousemove = null;
                }
            }
        }

        browser();

    </script>
</body>
</html>
